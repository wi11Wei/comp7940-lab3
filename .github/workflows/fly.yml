name: Fly Deploy
on:
 push:
  branches:
   - main
jobs:
 deploy:
  name: Deploy app
  runs-on: ubuntu-latest
  concurrency: deploy-group
  steps:
   - name: Checkout code
     uses: actions/checkout@v3

   - name: Install Flyctl
     run: superfly/flyctl-actions/setup-flyctl@master

   - name: Login to Fly.io
     run: flyctl auth login --access-token ${{ secrets.FLY_API_TOKEN }}

   - name: Deploy to Fly.io
     run: flyctl deploy